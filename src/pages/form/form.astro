---
const handleSubmit = async (event) => {
  event.preventDefault();
  
  const form = event.target;
  const data = {
    name: form.name.value,
    email: form.email.value,
    type: "HP問い合わせ", // 必須なので固定値
    message: form.message.value
  };

  try {
    const res = await fetch('/api/contact', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json; charset=UTF-8' },
      body: JSON.stringify(data)
    });

    const result = await res.json();
    alert(result.message);
    form.reset();
  } catch (err) {
    console.error(err);
    alert('送信中にエラーが発生しました');
  }
};
---

<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>お問い合わせフォーム</title>
  </head>
  <body>
    <h1>お問い合わせフォーム</h1>
    <form id="contactForm" on:submit={handleSubmit}>
      <label>
        名前 (必須)
        <input type="text" name="name" required>
      </label>
      <br>
      <label>
        メール (必須)
        <input type="email" name="email" required>
      </label>
      <br>
      <label>
        メッセージ (必須)
        <textarea name="message" required></textarea>
      </label>
      <br>
      <button type="submit">送信</button>
    </form>
  </body>
</html>
